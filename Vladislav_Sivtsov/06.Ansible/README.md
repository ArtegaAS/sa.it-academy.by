### 06.Ansible 
```bash
vim playbook_nginx.yaml
vim invent.yaml 
mkdir -p ~/06.Ansible/templates
vim ~/06.Ansible/templates/nginx_vhost.conf.j2
ansible-playbook -i invent.yaml playbook_nginx.yaml -u root                                                    

PLAY [Install  and configure Nginx with two  virtual hosts] *****************************************************************

TASK [Gathering Facts] ******************************************************************************************************
Wednesday 09 April 2025  16:00:16 +0000 (0:00:00.023)       0:00:00.023 ******* 
ok: [host09]

TASK [Install Nginx] ********************************************************************************************************
Wednesday 09 April 2025  16:00:21 +0000 (0:00:04.805)       0:00:04.829 ******* 
ok: [host09]

TASK [Nginx control] ********************************************************************************************************
Wednesday 09 April 2025  16:00:24 +0000 (0:00:03.546)       0:00:08.375 *******
fatal: [host09]: FAILED! => {"changed": false, "msg": "Unable to start service nginx: Job for nginx.service failed because the control process exited with error code.\nSee \"systemctl status nginx.service\" and \"journalctl -xe\" for details.\n"}    

PLAY RECAP ******************************************************************************************************************
host09                     : ok=2    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0

Wednesday 09 April 2025  16:00:29 +0000 (0:00:04.633)       0:00:13.008 *******
===============================================================================
Gathering Facts ------------------------------------------------------------------------------------------------------ 4.81s 
Nginx control -------------------------------------------------------------------------------------------------------- 4.63s 
Install Nginx -------------------------------------------------------------------------------------------------------- 3.55s 
Playbook run took 0 days, 0 hours, 0 minutes, 13 seconds
```
### The problem was that port 80 was occupiyed by "apache 2". Then I went to remote host and kill the process (try to resolve problem in playbook but can't do it)
```bash
ssh root@192.168.201.9 -o ProxyCommand="ssh -W %h:%p -q jump_sa@178.124.206.53  -p 32510" 

root@ws-9:~# ss -tulnp | grep :80
tcp     LISTEN   0        511                    *:80                   *:*      users:(("apache2",pid=6139,fd=4),("apache2",pid=6138,fd=4),("apache2",pid=161,fd=4))
 
root@ws-9:~# systemctl stop "apache2"
root@ws-9:~# sudo systemctl disable "apache2"
Synchronizing state of apache2.service with SysV service script with /lib/systemd/systemd-sysv-install.
Executing: /lib/systemd/systemd-sysv-install disable apache2
Removed /etc/systemd/system/multi-user.target.wants/apache2.service.
root@ws-9:~# logout
```
Connection to 192.168.201.9 closed.

```bash 
-i invent.yaml playbook_nginx.yaml -u root 
                                                                                                                                                                                              

 PLAY [Install and configure Nginx with two virtual hosts] *******************************************************************************************************************************************************************************

TASK [Gathering Facts] ******************************************************************************************************************************************************************************************************************
Wednesday 09 April 2025  17:43:03 +0000 (0:00:00.016)       0:00:00.016 *******
ok: [host09]

TASK [Install Nginx] ********************************************************************************************************************************************************************************************************************
Wednesday 09 April 2025  17:43:07 +0000 (0:00:03.813)       0:00:03.829 *******
ok: [host09]

TASK [Ensure Nginx is running] **********************************************************************************************************************************************************************************************************
Wednesday 09 April 2025  17:43:10 +0000 (0:00:03.027)       0:00:06.856 *******
ok: [host09]

TASK [Create root directories] **********************************************************************************************************************************************************************************************************
Wednesday 09 April 2025  17:43:12 +0000 (0:00:02.264)       0:00:09.121 ******* 
ok: [host09] => (item={'name': 'site1.example.com', 'root_dir': '/var/www/site1', 'index_content': 'Hello from Site 1', 'port': 80})
ok: [host09] => (item={'name': 'site2.example.com', 'root_dir': '/var/www/site2', 'index_content': 'Hello from Site 2', 'port': 80})

TASK [Add index.html with unique content] ***********************************************************************************************************************************************************************************************
Wednesday 09 April 2025  17:43:14 +0000 (0:00:02.615)       0:00:11.737 *******
ok: [host09] => (item={'name': 'site1.example.com', 'root_dir': '/var/www/site1', 'index_content': 'Hello from Site 1', 'port': 80})
ok: [host09] => (item={'name': 'site2.example.com', 'root_dir': '/var/www/site2', 'index_content': 'Hello from Site 2', 'port': 80})

TASK [Configure Nginx virtual hosts] ****************************************************************************************************************************************************************************************************
Wednesday 09 April 2025  17:43:19 +0000 (0:00:04.054)       0:00:15.792 *******
ok: [host09] => (item={'name': 'site1.example.com', 'root_dir': '/var/www/site1', 'index_content': 'Hello from Site 1', 'port': 80})
ok: [host09] => (item={'name': 'site2.example.com', 'root_dir': '/var/www/site2', 'index_content': 'Hello from Site 2', 'port': 80})

TASK [Enable virtual hosts] *************************************************************************************************************************************************************************************************************
Wednesday 09 April 2025  17:43:22 +0000 (0:00:03.937)       0:00:19.729 *******
ok: [host09] => (item={'name': 'site1.example.com', 'root_dir': '/var/www/site1', 'index_content': 'Hello from Site 1', 'port': 80})
ok: [host09] => (item={'name': 'site2.example.com', 'root_dir': '/var/www/site2', 'index_content': 'Hello from Site 2', 'port': 80})

TASK [Remove default Nginx config] ******************************************************************************************************************************************************************************************************
Wednesday 09 April 2025  17:43:25 +0000 (0:00:02.353)       0:00:22.082 *******
ok: [host09]

TASK [Verify virtual hosts content] *****************************************************************************************************************************************************************************************************
Wednesday 09 April 2025  17:43:26 +0000 (0:00:01.243)       0:00:23.327 *******
ok: [host09] => (item={'name': 'site1.example.com', 'root_dir': '/var/www/site1', 'index_content': 'Hello from Site 1', 'port': 80})
ok: [host09] => (item={'name': 'site2.example.com', 'root_dir': '/var/www/site2', 'index_content': 'Hello from Site 2', 'port': 80})

TASK [Show verification results] ********************************************************************************************************************************************************************************************************
Wednesday 09 April 2025  17:43:29 +0000 (0:00:02.774)       0:00:26.101 *******
ok: [host09] => (item=site1.example.com) => {
    "msg": "Host site1.example.com returned: Hello from Site 1"
}
ok: [host09] => (item=site2.example.com) => {
    "msg": "Host site2.example.com returned: Hello from Site 2"
}

PLAY RECAP ******************************************************************************************************************************************************************************************************************************
host09                     : ok=10   changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0

Wednesday 09 April 2025  17:43:29 +0000 (0:00:00.301)       0:00:26.403 *******
===============================================================================
Add index.html with unique content ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 4.05s 
Configure Nginx virtual hosts ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 3.94s 
Gathering Facts ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ 3.81s 
Install Nginx -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 3.03s 
Verify virtual hosts content ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 2.77s 
Create root directories ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 2.62s 
Enable virtual hosts ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 2.35s 
Ensure Nginx is running ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 2.26s 
Remove default Nginx config ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ 1.24s 
Show verification results -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 0.30s 
Playbook run took 0 days, 0 hours, 0 minutes, 26 seconds
```